<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Cloudflare Config Assistant</title>
    <link rel="icon" type="image/png" href="/assets/cf_favicon.png" />
    <link rel="stylesheet" href="/css/app.css" />
  </head>

  <body>
    <header>
      <div class="wrap">
        <div class="nav">
          <div class="brand">
            <div class="dot"></div>
            <div>
              Cloudflare Config Assistant
              <div class="tiny" id="subline">v1.0 Developed by:<a href="https://www.preyashyadav.com">Preyash Yadav</a></div>
            </div>
          </div>
          <div class="navRight">
            <span id="userGreeting" class="tiny" style="display:none;"></span>
            <span id="guestBadge" class="tiny" style="display:none;">You are in Guest Mode</span>
            <button id="btnLogin">Login</button>
            <button id="btnLogout" style="display:none;">Logout</button>
          </div>
        </div>
      </div>
    </header>

    <div class="shell">
      <div class="sidebar">
        <div class="sideHd">
          <div>
            <div class="sideTitle">Chats</div>
            <div class="tiny" id="chatMeta">—</div>
          </div>
          <button class="primary btnIcon" id="btnNewChat" title="New chat" aria-label="New chat">
            <i data-lucide="plus"></i>
          </button>
        </div>
        <div class="sideBd" id="chatList"></div>
      </div>

      <div class="chat">
        <div class="chatHeader">
          <div class="chatTitle" id="chatTitle">New chat</div>
          <div class="chatActions">
            <button class="iconBtn" id="btnShareChat" title="Share chat" aria-label="Share chat">
              <i data-lucide="share-2"></i>
            </button>
            <button class="iconBtn" id="btnDownloadChat" title="Download chat" aria-label="Download chat">
              <i data-lucide="download"></i>
            </button>
            <button class="iconBtn" id="btnChatSettings" title="Sources & settings" aria-label="Sources and settings">
              <i data-lucide="settings"></i>
            </button>
          </div>
        </div>
        <div class="chatBody" id="chatBody"></div>
        <div class="tiny" id="hint" style="display:none;"></div>

        <div class="composer">
          <input id="input" type="text" placeholder="Message the assistant…" />
          <button class="micBtn" id="btnMic" title="Voice input" aria-label="Voice input">
            <i data-lucide="mic"></i>
          </button>
          <button class="primary" id="btnSend">Send</button>
        </div>
      </div>
    </div>

    <div class="overlay" id="overlay">
      <div class="loaderCard">
        <div class="spinnerRow">
          <div class="spinner"></div>
          <div class="loaderTitle" id="overlayTitle">Thinking…</div>
        </div>
        <div class="loaderMsg" id="overlayMsg">Calling the agent.</div>
      </div>
    </div>

    <div class="toast" id="toast">
      <div class="t" id="toastTitle">Notice</div>
      <div class="m" id="toastMsg"></div>
    </div>

    <div class="drawerMask" id="drawerMask"></div>
    <div class="drawer" id="drawer">
      <div class="drawerHd">
        <div style="font-weight:900;">Settings / Dev</div>
        <button class="btnIcon" id="btnCloseDrawer" title="Close" aria-label="Close">
          <i data-lucide="x"></i>
        </button>
      </div>
      <div class="drawerBd">
        <div class="sectionTitle">Status</div>
        <div class="pill" style="width: fit-content;">
          <span class="pDot" id="dotW"></span><i data-lucide="cloud"></i><span id="pillW">Worker</span>
        </div>
        <div style="height:8px;"></div>
        <div class="pill" style="width: fit-content;">
          <span class="pDot" id="dotDO"></span><i data-lucide="database"></i><span id="pillDO">DO</span>
        </div>
        <div style="height:8px;"></div>
        <div class="pill" style="width: fit-content;">
          <span class="pDot" id="dotDiag"></span><i data-lucide="link-2"></i><span id="pillDiag">Bindings</span>
        </div>

        <div class="sectionTitle">Skeleton</div>
        <div id="skeletonLog" class="tiny">—</div>

        <div class="sectionTitle">Actions</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
          <button class="btnIcon" id="btnNewGoal"><i data-lucide="flag"></i>New goal</button>
          <button class="primary btnIcon" id="btnPlan"><i data-lucide="sparkles"></i>Generate plan</button>
          <button class="primary btnIcon" id="btnSeed"><i data-lucide="database"></i>Seed KB</button>
          <button class="btnIcon" id="btnCopy"><i data-lucide="copy"></i>Copy plan JSON</button>
        </div>

        <div class="sectionTitle">Sources</div>
        <div id="sourcesList" class="tiny">—</div>

        <div class="sectionTitle">Latest Plan JSON</div>
        <pre id="planJson">{}</pre>
      </div>
    </div>

    <script src="https://cdn.auth0.com/js/auth0-spa-js/2.1/auth0-spa-js.production.js"></script>
    <script src="https://unpkg.com/lucide@0.563.1/dist/umd/lucide.min.js"></script>
    <script type="module" src="/js/app.js"></script>
  </body>
</html>
